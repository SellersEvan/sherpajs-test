var X=Object.defineProperty;var Y=(o,e)=>{for(var t in e)X(o,t,{get:e[t],enumerable:!0})};var p=class extends URL{constructor(e,t){super(e,t||"http://0.0"),this.pathname=this.pathname.endsWith("/")?this.pathname.slice(0,-1):this.pathname}};var u=class o{parameters={};has(e){return this.parameters[e]!=null}get(e){if(!(!this.has(e)||this.parameters[e].length==0))return this.parameters[e][0]}getAll(e){if(this.has(e))return this.parameters[e]}keys(){return Object.keys(this.parameters)}toJSON(){return{...this.parameters}}static getPathParams(e,t){let r=new o;return new p(e).pathname.split("/").filter(s=>s!="").forEach((s,d)=>{t[d].isDynamic&&r.append(t[d].name,s,!1)}),r}static getQueryParams(e){let t=new o;return new p(e).searchParams.forEach((r,s)=>{t.append(s,r)}),t}append(e,t,r=!0){this.has(e)||(this.parameters[e]=[]),this.parameters[e].push(...this.parse(t,r))}parse(e,t){return t&&e.includes(",")?e.split(",").map(r=>this.parse(r,t)).flat():e=="true"?[!0]:e=="false"?[!1]:/^\d+$/.test(e)?[parseInt(e)]:[e]}};var c=class o{headers;constructor(e){this.headers={},e&&(e instanceof Headers||e instanceof o?e.forEach((t,r)=>{this.set(r,t)}):Array.isArray(e)?e.forEach(([t,r])=>{this.append(t,r)}):Object.entries(e).forEach(([t,r])=>{Array.isArray(r)?r.forEach(s=>this.append(t,s)):this.set(t,r)}))}append(e,t){let r=e.toLowerCase();this.headers[r]=this.headers[r]?`${this.headers[r]}, ${t}`:t}has(e){return this.get(e)!=null}get(e){return this.headers[e.toLowerCase()]||null}set(e,t){this.headers[e.toLowerCase()]=t}delete(e){delete this.headers[e.toLowerCase()]}toJSON(){return{...this.headers}}toString(){return JSON.stringify(this.headers)}getSetCookie(){return Object.entries(this.headers).filter(([e])=>e.toLowerCase()==="set-cookie").flatMap(([,e])=>e.split(", "))}forEach(e,t){for(let[r,s]of Object.entries(this.headers))e.call(t,s,r,this)}keys(){return Object.keys(this.headers)[Symbol.iterator]()}values(){return Object.values(this.headers)[Symbol.iterator]()}entries(){return Object.entries(this.headers)[Symbol.iterator]()}*[Symbol.iterator](){for(let[e,t]of Object.entries(this.headers))yield[e,t]}};var i;(function(o){o.JSON="JSON",o.Text="Text",o.None="None"})(i||(i={}));var N={[i.JSON]:"application/json",[i.Text]:"text/plain",[i.None]:void 0};var P={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot \u{1FAD6}",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};var W={headers:new c,status:200},m=class o{static new(e){let t=o.defaultOptions(i.None,e);return{status:t.status,statusText:o.getStatusText(t.status),headers:t.headers,body:void 0,bodyType:i.None}}static text(e,t){let r=o.defaultOptions(i.Text,t);return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:e.toString(),bodyType:i.Text}}static JSON(e,t){let r=o.defaultOptions(i.JSON,t),s=e.toJSON&&typeof e.toJSON=="function";return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:s?e.toJSON():e,bodyType:i.JSON}}static redirect(e,t){let r=o.defaultOptions(i.None,t);return r.headers.has("Location")||r.headers.set("Location",e),{status:302,statusText:o.getStatusText(302),headers:r.headers,body:void 0,bodyType:i.None}}static defaultOptions(e,t){let r={...W,...t};return r.headers.has("Content-Type")||r.headers.set("Content-Type",N[e]),r}static getStatusText(e){let t=P[e];if(!t)throw new Error(`Status code "${e}" is invalid.`);return t}};import*as S from"tty";var{env:h={},argv:B=[],platform:Q=""}=typeof process>"u"?{}:process,z="NO_COLOR"in h||B.includes("--no-color"),K="FORCE_COLOR"in h||B.includes("--color"),Z=Q==="win32",v=h.TERM==="dumb",ee=S&&S.isatty&&S.isatty(1)&&h.TERM&&!v,te="CI"in h&&("GITHUB_ACTIONS"in h||"GITLAB_CI"in h||"CIRCLECI"in h),re=!z&&(K||Z&&!v||ee||te),M=(o,e,t,r,s=e.substring(0,o)+r,d=e.substring(o+t.length),l=d.indexOf(t))=>s+(l<0?d:M(l,d,t,r)),oe=(o,e,t,r,s)=>o<0?t+e+r:t+M(o,e,r,s)+r,se=(o,e,t=o,r=o.length+1)=>s=>s||!(s===""||s===void 0)?oe((""+s).indexOf(e,r),s,o,e,t):"",n=(o,e,t)=>se(`\x1B[${o}m`,`\x1B[${e}m`,t),L={reset:n(0,0),bold:n(1,22,"\x1B[22m\x1B[1m"),dim:n(2,22,"\x1B[22m\x1B[2m"),italic:n(3,23),underline:n(4,24),inverse:n(7,27),hidden:n(8,28),strikethrough:n(9,29),black:n(30,39),red:n(31,39),green:n(32,39),yellow:n(33,39),blue:n(34,39),magenta:n(35,39),cyan:n(36,39),white:n(37,39),gray:n(90,39),bgBlack:n(40,49),bgRed:n(41,49),bgGreen:n(42,49),bgYellow:n(43,49),bgBlue:n(44,49),bgMagenta:n(45,49),bgCyan:n(46,49),bgWhite:n(47,49),blackBright:n(90,39),redBright:n(91,39),greenBright:n(92,39),yellowBright:n(93,39),blueBright:n(94,39),magentaBright:n(95,39),cyanBright:n(96,39),whiteBright:n(97,39),bgBlackBright:n(100,49),bgRedBright:n(101,49),bgGreenBright:n(102,49),bgYellowBright:n(103,49),bgBlueBright:n(104,49),bgMagentaBright:n(105,49),bgCyanBright:n(106,49),bgWhiteBright:n(107,49)},ne=({useColor:o=re}={})=>o?L:Object.keys(L).reduce((e,t)=>({...e,[t]:String}),{}),{reset:Ue,bold:A,dim:He,italic:_e,underline:ke,inverse:Ve,hidden:Je,strikethrough:$e,black:Fe,red:U,green:H,yellow:De,blue:Ge,magenta:_,cyan:k,white:je,gray:V,bgBlack:qe,bgRed:Xe,bgGreen:Ye,bgYellow:We,bgBlue:Qe,bgMagenta:ze,bgCyan:Ke,bgWhite:Ze,blackBright:et,redBright:tt,greenBright:rt,yellowBright:ot,blueBright:st,magentaBright:nt,cyanBright:at,whiteBright:it,bgBlackBright:dt,bgRedBright:pt,bgGreenBright:lt,bgYellowBright:ut,bgBlueBright:ct,bgMagentaBright:ht,bgCyanBright:mt,bgWhiteBright:ft}=ne();var ae=["GET","POST","PATCH","DELETE","PUT"],Rt=[...ae];var f;(function(o){o.GET="GET",o.PUT="PUT",o.POST="POST",o.PATCH="PATCH",o.DELETE="DELETE"})(f||(f={}));var J;(function(o){o.Vercel="Vercel",o.local="local"})(J||(J={}));var x=class{static async Local(e,t){if(!e.url||!e.method)throw new Error("Missing URL and Methods");let r=new c(e.headers),{body:s,bodyType:d}=await this.parseBodyLocal(e,r);return{url:new p(e.url).pathname,params:{path:u.getPathParams(e.url,t),query:u.getQueryParams(e.url)},method:e.method.toUpperCase(),headers:r,body:s,bodyType:d}}static parseBodyLocal(e,t){return new Promise(r=>{if(e.method.toUpperCase()==f.GET){r({body:void 0,bodyType:i.None});return}let s="",d=i.Text;e.on("data",l=>{s+=l.toString()}),e.on("end",()=>{let l=(t.get("Content-Type")||"").toLowerCase();(!l||s=="")&&r({body:void 0,bodyType:i.None}),l=="application/json"&&(s=JSON.parse(s),d=i.JSON),r({body:s,bodyType:d})}),e.on("error",()=>{r({body:void 0,bodyType:i.None})})})}static async Vercel(e,t){let r=new c(e.headers),{body:s,bodyType:d}=await this.parseBodyVercel(e,r);return{url:new p(e.url).pathname,params:{path:u.getPathParams(e.url,t),query:u.getQueryParams(e.url)},method:e.method.toUpperCase(),headers:r,body:s,bodyType:d}}static async parseBodyVercel(e,t){if(e.method.toUpperCase()==f.GET)return{body:void 0,bodyType:i.None};let r=(t.get("Content-Type")||"").toLowerCase();return r?r=="application/json"?{body:await e.json(),bodyType:i.JSON}:{body:await e.text(),bodyType:i.Text}:{body:void 0,bodyType:i.None}}};var ie=Response,R=class{static Local(e,t,r){this.applyRedirectHeaders(e,t),r.statusCode=t.status,r.statusMessage=t.statusText;for(let[s,d]of t.headers.entries())d&&r.setHeader(s,d);r.end(this.getBody(t))}static Vercel(e,t){return this.applyRedirectHeaders(e,t),new ie(this.getBody(t),{headers:t.headers,status:t.status,statusText:t.statusText})}static getBody(e){switch(e.bodyType){case i.Text:return e.body;case i.JSON:return JSON.stringify(e.body)}}static applyRedirectHeaders(e,t){if(t.headers.has("Location")){let r=e.headers.get("host"),d=`${r.toLowerCase().includes("localhost")?"http":"https"}://${r}`,l=new p(e.url,d),T=l.origin+l.pathname;T=T.endsWith("/")?T:`${T}/`,t.headers.set("Location",new p(t.headers.get("Location"),T).href)}}};async function $(o,e,t){let r=o[t.method];if(r)try{let s=await r(t,e);return s||m.new({status:200})}catch(s){return m.text(s.message,{status:500})}else return m.new({status:405})}var E={RequestTransform:x,ResponseTransform:R,Handler:$};var I={};Y(I,{GET:()=>ce});var y=class o{headers;constructor(e){this.headers={},e&&(e instanceof Headers||e instanceof o?e.forEach((t,r)=>{this.set(r,t)}):Array.isArray(e)?e.forEach(([t,r])=>{this.append(t,r)}):Object.entries(e).forEach(([t,r])=>{Array.isArray(r)?r.forEach(s=>this.append(t,s)):this.set(t,r)}))}append(e,t){let r=e.toLowerCase();this.headers[r]=this.headers[r]?`${this.headers[r]}, ${t}`:t}has(e){return this.get(e)!=null}get(e){return this.headers[e.toLowerCase()]||null}set(e,t){this.headers[e.toLowerCase()]=t}delete(e){delete this.headers[e.toLowerCase()]}toJSON(){return{...this.headers}}toString(){return JSON.stringify(this.headers)}getSetCookie(){return Object.entries(this.headers).filter(([e])=>e.toLowerCase()==="set-cookie").flatMap(([,e])=>e.split(", "))}forEach(e,t){for(let[r,s]of Object.entries(this.headers))e.call(t,s,r,this)}keys(){return Object.keys(this.headers)[Symbol.iterator]()}values(){return Object.values(this.headers)[Symbol.iterator]()}entries(){return Object.entries(this.headers)[Symbol.iterator]()}*[Symbol.iterator](){for(let[e,t]of Object.entries(this.headers))yield[e,t]}};var F={JSON:"application/json",Text:"text/plain",None:void 0};var w=class{static server(e){return e}static module(e){return{...e,load:t=>new e.interface(t)}}};var D={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot \u{1FAD6}",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};var de={headers:new y,status:200},g=class o{static new(e){let t=o.defaultOptions("None",e);return{status:t.status,statusText:o.getStatusText(t.status),headers:t.headers,body:void 0,bodyType:"None"}}static text(e,t){let r=o.defaultOptions("Text",t);return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:e.toString(),bodyType:"Text"}}static JSON(e,t){let r=o.defaultOptions("JSON",t),s=e.toJSON&&typeof e.toJSON=="function";return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:s?e.toJSON():e,bodyType:"JSON"}}static redirect(e,t){let r=o.defaultOptions("None",t);return r.headers.has("Location")||r.headers.set("Location",e),{status:302,statusText:o.getStatusText(302),headers:r.headers,body:void 0,bodyType:"None"}}static defaultOptions(e,t){let r={...de,...t};return r.headers.has("Content-Type")||r.headers.set("Content-Type",F[e]),r}static getStatusText(e){let t=D[e];if(!t)throw new Error(`Status code "${e}" is invalid.`);return t}};var pe=["GET","POST","PATCH","DELETE","PUT"],Or=[...pe],b=class{context;constructor(e){this.context=e}};var G={New:w};function ce(o,e){return g.JSON({request:o,context:e})}var j=G.New.module({name:"pass-primary-2",interface:b});var q=j.load({test:!0});var he=q.context,me=[{name:"module",isDynamic:!1},{name:"m2",isDynamic:!1}];async function fe(o,e){let t=await E.RequestTransform.Vercel(o,me),r=await E.Handler(I,he,t);return E.ResponseTransform.Vercel(t,r)}export{fe as default};
// Generated by SherpaJS
