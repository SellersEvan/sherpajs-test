var G=Object.defineProperty;var X=(o,e)=>{for(var t in e)G(o,t,{get:e[t],enumerable:!0})};var p=class extends URL{constructor(e,t){super(e,t||"http://0.0"),this.pathname=this.pathname.endsWith("/")?this.pathname.slice(0,-1):this.pathname}};var u=class o{parameters={};has(e){return this.parameters[e]!=null}get(e){if(!(!this.has(e)||this.parameters[e].length==0))return this.parameters[e][0]}getAll(e){if(this.has(e))return this.parameters[e]}keys(){return Object.keys(this.parameters)}toJSON(){return{...this.parameters}}static getPathParams(e,t){let r=new o;return new p(e).pathname.split("/").filter(s=>s!="").forEach((s,d)=>{t[d].isDynamic&&r.append(t[d].name,s,!1)}),r}static getQueryParams(e){let t=new o;return new p(e).searchParams.forEach((r,s)=>{t.append(s,r)}),t}append(e,t,r=!0){this.has(e)||(this.parameters[e]=[]),this.parameters[e].push(...this.parse(t,r))}parse(e,t){return t&&e.includes(",")?e.split(",").map(r=>this.parse(r,t)).flat():e=="true"?[!0]:e=="false"?[!1]:/^\d+$/.test(e)?[parseInt(e)]:[e]}};var c=class o{headers;constructor(e){this.headers={},e&&(e instanceof Headers||e instanceof o?e.forEach((t,r)=>{this.set(r,t)}):Array.isArray(e)?e.forEach(([t,r])=>{this.append(t,r)}):Object.entries(e).forEach(([t,r])=>{Array.isArray(r)?r.forEach(s=>this.append(t,s)):this.set(t,r)}))}append(e,t){let r=e.toLowerCase();this.headers[r]=this.headers[r]?`${this.headers[r]}, ${t}`:t}has(e){return this.get(e)!=null}get(e){return this.headers[e.toLowerCase()]||null}set(e,t){this.headers[e.toLowerCase()]=t}delete(e){delete this.headers[e.toLowerCase()]}toJSON(){return{...this.headers}}toString(){return JSON.stringify(this.headers)}getSetCookie(){return Object.entries(this.headers).filter(([e])=>e.toLowerCase()==="set-cookie").flatMap(([,e])=>e.split(", "))}forEach(e,t){for(let[r,s]of Object.entries(this.headers))e.call(t,s,r,this)}keys(){return Object.keys(this.headers)[Symbol.iterator]()}values(){return Object.values(this.headers)[Symbol.iterator]()}entries(){return Object.entries(this.headers)[Symbol.iterator]()}*[Symbol.iterator](){for(let[e,t]of Object.entries(this.headers))yield[e,t]}};var i;(function(o){o.JSON="JSON",o.Text="Text",o.None="None"})(i||(i={}));var I={[i.JSON]:"application/json",[i.Text]:"text/plain",[i.None]:void 0};var N={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot \u{1FAD6}",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};var q={headers:new c,status:200},m=class o{static new(e){let t=o.defaultOptions(i.None,e);return{status:t.status,statusText:o.getStatusText(t.status),headers:t.headers,body:void 0,bodyType:i.None}}static text(e,t){let r=o.defaultOptions(i.Text,t);return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:e.toString(),bodyType:i.Text}}static JSON(e,t){let r=o.defaultOptions(i.JSON,t),s=e.toJSON&&typeof e.toJSON=="function";return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:s?e.toJSON():e,bodyType:i.JSON}}static redirect(e,t){let r=o.defaultOptions(i.None,t);return r.headers.has("Location")||r.headers.set("Location",e),{status:302,statusText:o.getStatusText(302),headers:r.headers,body:void 0,bodyType:i.None}}static defaultOptions(e,t){let r={...q,...t};return r.headers.has("Content-Type")||r.headers.set("Content-Type",I[e]),r}static getStatusText(e){let t=N[e];if(!t)throw new Error(`Status code "${e}" is invalid.`);return t}};import*as b from"tty";var{env:h={},argv:L=[],platform:Y=""}=typeof process>"u"?{}:process,W="NO_COLOR"in h||L.includes("--no-color"),Q="FORCE_COLOR"in h||L.includes("--color"),z=Y==="win32",B=h.TERM==="dumb",K=b&&b.isatty&&b.isatty(1)&&h.TERM&&!B,Z="CI"in h&&("GITHUB_ACTIONS"in h||"GITLAB_CI"in h||"CIRCLECI"in h),ee=!W&&(Q||z&&!B||K||Z),v=(o,e,t,r,s=e.substring(0,o)+r,d=e.substring(o+t.length),l=d.indexOf(t))=>s+(l<0?d:v(l,d,t,r)),te=(o,e,t,r,s)=>o<0?t+e+r:t+v(o,e,r,s)+r,re=(o,e,t=o,r=o.length+1)=>s=>s||!(s===""||s===void 0)?te((""+s).indexOf(e,r),s,o,e,t):"",n=(o,e,t)=>re(`\x1B[${o}m`,`\x1B[${e}m`,t),P={reset:n(0,0),bold:n(1,22,"\x1B[22m\x1B[1m"),dim:n(2,22,"\x1B[22m\x1B[2m"),italic:n(3,23),underline:n(4,24),inverse:n(7,27),hidden:n(8,28),strikethrough:n(9,29),black:n(30,39),red:n(31,39),green:n(32,39),yellow:n(33,39),blue:n(34,39),magenta:n(35,39),cyan:n(36,39),white:n(37,39),gray:n(90,39),bgBlack:n(40,49),bgRed:n(41,49),bgGreen:n(42,49),bgYellow:n(43,49),bgBlue:n(44,49),bgMagenta:n(45,49),bgCyan:n(46,49),bgWhite:n(47,49),blackBright:n(90,39),redBright:n(91,39),greenBright:n(92,39),yellowBright:n(93,39),blueBright:n(94,39),magentaBright:n(95,39),cyanBright:n(96,39),whiteBright:n(97,39),bgBlackBright:n(100,49),bgRedBright:n(101,49),bgGreenBright:n(102,49),bgYellowBright:n(103,49),bgBlueBright:n(104,49),bgMagentaBright:n(105,49),bgCyanBright:n(106,49),bgWhiteBright:n(107,49)},oe=({useColor:o=ee}={})=>o?P:Object.keys(P).reduce((e,t)=>({...e,[t]:String}),{}),{reset:Me,bold:M,dim:Ae,italic:Ue,underline:He,inverse:_e,hidden:ke,strikethrough:Ve,black:Je,red:A,green:U,yellow:$e,blue:Fe,magenta:H,cyan:_,white:De,gray:k,bgBlack:je,bgRed:Ge,bgGreen:Xe,bgYellow:qe,bgBlue:Ye,bgMagenta:We,bgCyan:Qe,bgWhite:ze,blackBright:Ke,redBright:Ze,greenBright:et,yellowBright:tt,blueBright:rt,magentaBright:ot,cyanBright:st,whiteBright:nt,bgBlackBright:at,bgRedBright:it,bgGreenBright:dt,bgYellowBright:pt,bgBlueBright:lt,bgMagentaBright:ut,bgCyanBright:ct,bgWhiteBright:ht}=oe();var se=["GET","POST","PATCH","DELETE","PUT"],St=[...se];var f;(function(o){o.GET="GET",o.PUT="PUT",o.POST="POST",o.PATCH="PATCH",o.DELETE="DELETE"})(f||(f={}));var V;(function(o){o.Vercel="Vercel",o.local="local"})(V||(V={}));var S=class{static async Local(e,t){if(!e.url||!e.method)throw new Error("Missing URL and Methods");let r=new c(e.headers),{body:s,bodyType:d}=await this.parseBodyLocal(e,r);return{url:new p(e.url).pathname,params:{path:u.getPathParams(e.url,t),query:u.getQueryParams(e.url)},method:e.method.toUpperCase(),headers:r,body:s,bodyType:d}}static parseBodyLocal(e,t){return new Promise(r=>{if(e.method.toUpperCase()==f.GET){r({body:void 0,bodyType:i.None});return}let s="",d=i.Text;e.on("data",l=>{s+=l.toString()}),e.on("end",()=>{let l=(t.get("Content-Type")||"").toLowerCase();(!l||s=="")&&r({body:void 0,bodyType:i.None}),l=="application/json"&&(s=JSON.parse(s),d=i.JSON),r({body:s,bodyType:d})}),e.on("error",()=>{r({body:void 0,bodyType:i.None})})})}static async Vercel(e,t){let r=new c(e.headers),{body:s,bodyType:d}=await this.parseBodyVercel(e,r);return{url:new p(e.url).pathname,params:{path:u.getPathParams(e.url,t),query:u.getQueryParams(e.url)},method:e.method.toUpperCase(),headers:r,body:s,bodyType:d}}static async parseBodyVercel(e,t){if(e.method.toUpperCase()==f.GET)return{body:void 0,bodyType:i.None};let r=(t.get("Content-Type")||"").toLowerCase();return r?r=="application/json"?{body:await e.json(),bodyType:i.JSON}:{body:await e.text(),bodyType:i.Text}:{body:void 0,bodyType:i.None}}};var ne=Response,x=class{static Local(e,t,r){this.applyRedirectHeaders(e,t),r.statusCode=t.status,r.statusMessage=t.statusText;for(let[s,d]of t.headers.entries())d&&r.setHeader(s,d);r.end(this.getBody(t))}static Vercel(e,t){return this.applyRedirectHeaders(e,t),new ne(this.getBody(t),{headers:t.headers,status:t.status,statusText:t.statusText})}static getBody(e){switch(e.bodyType){case i.Text:return e.body;case i.JSON:return JSON.stringify(e.body)}}static applyRedirectHeaders(e,t){if(t.headers.has("Location")){let r=e.headers.get("host"),d=`${r.toLowerCase().includes("localhost")?"http":"https"}://${r}`,l=new p(e.url,d),T=l.origin+l.pathname;T=T.endsWith("/")?T:`${T}/`,t.headers.set("Location",new p(t.headers.get("Location"),T).href)}}};async function J(o,e,t){let r=o[t.method];if(r)try{let s=await r(t,e);return s||m.new({status:200})}catch(s){return m.text(s.message,{status:500})}else return m.new({status:405})}var R={RequestTransform:S,ResponseTransform:x,Handler:J};var C={};X(C,{GET:()=>le});var y=class o{headers;constructor(e){this.headers={},e&&(e instanceof Headers||e instanceof o?e.forEach((t,r)=>{this.set(r,t)}):Array.isArray(e)?e.forEach(([t,r])=>{this.append(t,r)}):Object.entries(e).forEach(([t,r])=>{Array.isArray(r)?r.forEach(s=>this.append(t,s)):this.set(t,r)}))}append(e,t){let r=e.toLowerCase();this.headers[r]=this.headers[r]?`${this.headers[r]}, ${t}`:t}has(e){return this.get(e)!=null}get(e){return this.headers[e.toLowerCase()]||null}set(e,t){this.headers[e.toLowerCase()]=t}delete(e){delete this.headers[e.toLowerCase()]}toJSON(){return{...this.headers}}toString(){return JSON.stringify(this.headers)}getSetCookie(){return Object.entries(this.headers).filter(([e])=>e.toLowerCase()==="set-cookie").flatMap(([,e])=>e.split(", "))}forEach(e,t){for(let[r,s]of Object.entries(this.headers))e.call(t,s,r,this)}keys(){return Object.keys(this.headers)[Symbol.iterator]()}values(){return Object.values(this.headers)[Symbol.iterator]()}entries(){return Object.entries(this.headers)[Symbol.iterator]()}*[Symbol.iterator](){for(let[e,t]of Object.entries(this.headers))yield[e,t]}};var $={JSON:"application/json",Text:"text/plain",None:void 0};var E=class{static server(e){return e}static module(e){return{...e,load:t=>new e.interface(t)}}};var F={100:"Continue",101:"Switching Protocols",102:"Processing",103:"Early Hints",200:"OK",201:"Created",202:"Accepted",203:"Non-Authoritative Information",204:"No Content",205:"Reset Content",206:"Partial Content",207:"Multi-Status",208:"Already Reported",226:"IM Used",300:"Multiple Choices",301:"Moved Permanently",302:"Found",303:"See Other",304:"Not Modified",307:"Temporary Redirect",308:"Permanent Redirect",400:"Bad Request",401:"Unauthorized",402:"Payment Required",403:"Forbidden",404:"Not Found",405:"Method Not Allowed",406:"Not Acceptable",407:"Proxy Authentication Required",408:"Request Timeout",409:"Conflict",410:"Gone",411:"Length Required",412:"Precondition Failed",413:"Payload Too Large",414:"URI Too Long",415:"Unsupported Media Type",416:"Range Not Satisfiable",417:"Expectation Failed",418:"I'm a Teapot \u{1FAD6}",421:"Misdirected Request",422:"Unprocessable Entity",423:"Locked",424:"Failed Dependency",425:"Too Early",426:"Upgrade Required",428:"Precondition Required",429:"Too Many Requests",431:"Request Header Fields Too Large",451:"Unavailable For Legal Reasons",500:"Internal Server Error",501:"Not Implemented",502:"Bad Gateway",503:"Service Unavailable",504:"Gateway Timeout",505:"HTTP Version Not Supported",506:"Variant Also Negotiates",507:"Insufficient Storage",508:"Loop Detected",510:"Not Extended",511:"Network Authentication Required"};var ae={headers:new y,status:200},g=class o{static new(e){let t=o.defaultOptions("None",e);return{status:t.status,statusText:o.getStatusText(t.status),headers:t.headers,body:void 0,bodyType:"None"}}static text(e,t){let r=o.defaultOptions("Text",t);return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:e.toString(),bodyType:"Text"}}static JSON(e,t){let r=o.defaultOptions("JSON",t),s=e.toJSON&&typeof e.toJSON=="function";return{status:r.status,statusText:o.getStatusText(r.status),headers:r.headers,body:s?e.toJSON():e,bodyType:"JSON"}}static redirect(e,t){let r=o.defaultOptions("None",t);return r.headers.has("Location")||r.headers.set("Location",e),{status:302,statusText:o.getStatusText(302),headers:r.headers,body:void 0,bodyType:"None"}}static defaultOptions(e,t){let r={...ae,...t};return r.headers.has("Content-Type")||r.headers.set("Content-Type",$[e]),r}static getStatusText(e){let t=F[e];if(!t)throw new Error(`Status code "${e}" is invalid.`);return t}};var ie=["GET","POST","PATCH","DELETE","PUT"],Er=[...ie];var D={New:E};function le(){return g.JSON({string:"food",number:3,boolean:!0,object:{numbers:[3,-4]}})}var j=D.New.server({context:"foo"});var ue=j.context,ce=[{name:"regular",isDynamic:!1},{name:"response",isDynamic:!1},{name:"json",isDynamic:!1},{name:"basic",isDynamic:!1}];async function he(o,e){let t=await R.RequestTransform.Vercel(o,ce),r=await R.Handler(C,ue,t);return R.ResponseTransform.Vercel(t,r)}export{he as default};
// Generated by SherpaJS
